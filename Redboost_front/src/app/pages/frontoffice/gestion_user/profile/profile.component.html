<div class="profile-container">
    <p-toast [style]="{marginTop: '70px'}"></p-toast>
    <div class="profile-card">
        <div class="profile-header">
            <div class="header-bg"></div>
            <div class="profile-content">
                <div class="profile-img-container">
                    <img [src]="user?.profile_pictureurl || 'assets/default-profile.png'" class="profile-img" alt="Profile photo" />
                    <div class="upload-overlay">
                        <button class="upload-button" (click)="fileInput.click()">
                            <i class="fas fa-camera"></i>
                        </button>
                        <input type="file" #fileInput (change)="onFileSelected($event)" accept="image/*" style="display: none" />
                    </div>
                </div>
                <div class="profile-info">
                    <h1 class="profile-name">
                        <span class="name-text">
                            <ng-container *ngIf="isEditingName; else displayName">
                                <input type="text" [(ngModel)]="tempFirstName" placeholder="First Name" class="name-input" />
                                <input type="text" [(ngModel)]="tempLastName" placeholder="Last Name" class="name-input" />
                                <button class="save-button" (click)="saveName()">Save</button>
                                <button class="cancel-button" (click)="cancelEditingName()">Cancel</button>
                            </ng-container>
                            <ng-template #displayName>
                                {{ user?.firstName }} {{ user?.lastName }}
                                <i class="fas fa-edit edit-icon" (click)="startEditingName()"></i>
                            </ng-template>
                        </span>
                        <span class="profile-badge">{{ user?.role | titlecase }}</span>
                    </h1>
                    <p class="profile-bio">{{ user?.bio || 'No bio available' }}</p>
                    <div class="social-links">
                        <a *ngIf="user?.facebookUrl" [href]="user.facebookUrl" target="_blank" class="social-link">
                            <i class="fab fa-facebook"></i>
                        </a>
                        <a *ngIf="user?.instagramUrl" [href]="user.instagramUrl" target="_blank" class="social-link">
                            <i class="fab fa-instagram"></i>
                        </a>
                        <a *ngIf="user?.linkedinUrl" [href]="user.linkedinUrl" target="_blank" class="social-link">
                            <i class="fab fa-linkedin"></i>
                        </a>
                    </div>
                </div>
            </div>
        </div>
        <div class="profile-details">
            <div class="profile-stats">
                <div class="stat-item" *ngFor="let stat of stats">
                    <div class="stat-number">{{ stat.currentValue }}</div>
                    <div class="stat-label">{{ stat.label }}</div>
                </div>
            </div>
            <div class="detail-section">
                <div class="section-header">
                    <h3 class="section-title"><i class="fas fa-user"></i> Personal Information</h3>
                </div>
                <div class="info-grid">
                    <div class="info-item">
                        <label>Email</label>
                        <p>{{ user?.email || 'Not specified' }}</p>
                    </div>
                    <div class="info-item">
                        <label>Phone</label>
                        <p>{{ user?.phoneNumber || 'Not specified' }}</p>
                    </div>
                </div>
            </div>
            <div class="detail-section">
                <div class="section-header">
                    <h3 class="section-title">
                        <i
                            [ngClass]="{
                                'fas fa-graduation-cap': user?.role === 'COACH',
                                'fas fa-briefcase': user?.role === 'ENTREPRENEUR',
                                'fas fa-money-bill-wave': user?.role === 'INVESTOR',
                                'fas fa-user-shield': user?.role === 'ADMIN' || user?.role === 'SUPERADMIN' || user?.role === 'EMPLOYEE'
                            }"
                        ></i>
                        {{ getRoleSectionTitle(user?.role) }}
                    </h3>
                </div>
                <div class="info-grid">
                    <ng-container *ngIf="user?.role === 'COACH'">
                        <div class="info-item">
                            <label>Experience</label>
                            <p>{{ user?.yearsOfExperience || '0' }} years</p>
                        </div>
                    </ng-container>
                    <ng-container *ngIf="user?.role === 'ENTREPRENEUR'">
                        <div class="info-item">
                            <label>Startup Name</label>
                            <p>{{ user?.startupName || 'Not specified' }}</p>
                        </div>
                        <div class="info-item">
                            <label>Industry</label>
                            <p>{{ user?.industry || 'Not specified' }}</p>
                        </div>
                    </ng-container>
                    <ng-container *ngIf="user?.role === 'INVESTOR'">
                        <div class="info-item">
                            <label>Investment Focus</label>
                            <p>{{ user?.investmentFocus || 'Not specified' }}</p>
                        </div>
                    </ng-container>
                    <ng-container *ngIf="user?.role !== 'COACH' && user?.role !== 'ENTREPRENEUR' && user?.role !== 'INVESTOR'">
                        <div class="info-item">
                            <label>Role Details</label>
                            <p>No additional details available for this role.</p>
                        </div>
                    </ng-container>
                </div>
            </div>
            <div class="detail-section" *ngIf="user?.role === 'COACH'">
                <div class="section-header">
                    <h3 class="section-title"><i class="fas fa-tools"></i> Skills and Expertise</h3>
                </div>
                <div class="tags-container">
                    <div class="tag-group">
                        <label class="tag-label">Skills</label>
                        <div class="tag-list">
                            <span *ngFor="let skill of (user?.skills ? user.skills.split(',') : [])" class="tag skill-tag">
                                {{ skill || 'Not specified' }}
                            </span>
                        </div>
                    </div>
                    <div class="tag-group">
                        <label class="tag-label">Expertise</label>
                        <div class="tag-list">
                            <span *ngFor="let expertise of (user?.expertise ? user.expertise.split(',') : [])" class="tag expertise-tag">
                                {{ expertise || 'Not specified' }}
                            </span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>